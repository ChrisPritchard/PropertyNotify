# Property Notify

![.NET](https://github.com/ChrisPritchard/PropertyNotify/actions/workflows/dotnet.yml/badge.svg) [![NuGet](https://img.shields.io/nuget/v/PropertyNotify.svg)](https://www.nuget.org/packages/PropertyNotify/)

This small project includes two classes: a [Generator.cs](./PropertyNotify/Generator.cs) and a [NotifyAttribute.cs](./PropertyNotify/NotifyAttribute.cs).

Together they work to silently implement the INotifyChanged, PropertyChanged pattern, turning plain `{ get; set; }` properties into 'full' properties with a backing field that call a method when changed.

> **NOTE:** this project requires the target project you use it with to be  **dotnet 9** and **langversion 13** (the default for 9.0) to work, as it needs [partial properties](https://learn.microsoft.com/en-us/dotnet/csharp/language-reference/proposals/csharp-13.0/partial-properties).

The notify attribute is added by the source generator as well, and will by default set the new property to call `OnPropertyChanged` with no arguments. Parameters can be sent to both change the method name it calls, to get it to pass the property name as a string argument, and to pass the prior value.

## Example

If you define a property like so:

```c#
using PropertyNotify;

public partial class ChildStyleMapFlat
{
  [Notify("OnPropChanged")]
  public partial bool Parent_BasicProperties { get; set; }

  private void OnPropChanged() 
  {
    // ...
  }

  // ...
}
```

Then Generator.cs (which is an [incremental source generator](https://github.com/dotnet/roslyn/blob/main/docs/features/incremental-generators.cookbook.md)) will *silently* (as in you wont see the output, but the compiler will) generate the following:

```c#
// <auto-generated/>
public partial class ChildStyleMapFlat
{
  private bool parent_BasicProperties;
  public partial bool Parent_BasicProperties
  {
    get => parent_BasicProperties;
    set 
    {
        if (!EqualityComparer<bool>.Default.Equals(parent_BasicProperties, value))
        {
           parent_BasicProperties = value;
           OnPropChanged();
        }
    }
  }
}
```

That is, any property with the **Notify** attribute will be turned into a property with a backing field that calls your specified function or the default when the property's value changes.

Simple!

If you want to see what its generating, you can add this to the property group of your using project:

```xml
<EmitCompilerGeneratedFiles>true</EmitCompilerGeneratedFiles>
<CompilerGeneratedFilesOutputPath>$(BaseIntermediateOutputPath)\GeneratedFiles</CompilerGeneratedFilesOutputPath>
```
